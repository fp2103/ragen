<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" const="text/html;charset=UTF-8" />
    <link rel="stylesheet" type="text/css" href="main.css">
    <title>RAGEN</title>
</head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<body>
    <div id="container">

        <div id="menu" style="display: none;">
            <input type="button" value="x" id="close" style="display: none;">

            <h3>Menu</h3>
            <label for="name">Driver Name:</label>
            <input type="text" id="name" maxlength="10" value="anon">
            <input type="color" id="color" value="#00ffff">

            <h4>Solo</h4>
            <label for="menu_seed">Track:</label>
            <input type="text" id="menu_seed" maxlength="10" value="">
            <input type="button" value="Random" id="menu_random">
            <input type="button" value="Go" id="menu_go">
            
            <h4>Multi</h4>
            <label for="session_id">Session ID:</label>
            <input list="session_id" style="width: 20%; text-transform: uppercase;"
                   maxlength="4" name="session_id" value="<%= sessionid %>">
            <datalist id="session_id"></datalist>
            <input type="button" value="Random" id="session_random">
            <input type="button" value="Join" id="session_go">
            <input type="button" value="Share" id="session_share">
        </div>

        <div id="game_elements" style="display: none;">

            <!-- fullsize scoreboard -->
            <div id="scoreboard"  style="display: block;">
                <input type="button" value="hide" id="hide" style="width: 100%; display: none;">
                <div id="track" class="scoreboard-data compact-hide">
                    <span>Track: </span>
                    <input type="text" name="seed" id="seed" maxlength="10">
                    <input type="button" value="Random" id="random">
                    <input type="button" value="Go" id="go">
                </div>
                <div id="session_info" class="scoreboard-data">
                    <span>Session: </span><span id="session_span">N/A</span>
                    <span>- Time remaining: </span><span id="remaining_time">&infin;</span>
                </div>
                <table id="leaderboard" class="leaderboard">
                    <tr class="ultra-hide">
                        <td>Leaderboard</td>
                        <th style="min-width: 3em;">Name</th>
                        <th>Sector 1</th>
                        <th>Sector 2</th>
                        <th>Lap</th>
                    </tr>
                </table>
                <input type="button" value="&equiv;" id="expand" style="width: 100%; display: none;">
            </div>

            <!-- Minimal scoreboard -->
            <div id="scoreboard_min" style="display: none;">
                <p id="session_info_min" style="display: none;">
                    Session Time rem.: <span id="remaining_time_2">00:00</span>
                </p>
                <div>
                    <p id="leaderboard_min" style="display: inline-block;">
                        <span id="player_min">-. anon</span> - <span id="time_min">-</span>
                    </p>
                    <input type="button" value="&equiv;" id="expand_min" style="display: inline-block;">
                </div>
            </div>

            <input id="menu_button" type="button" value="Menu">
            <p id="speed">0 km/h</p>
            <p id="score_message"></p>
            <canvas id="minimapc"></canvas>
            <canvas id="redalert"></canvas>
        </div>

        <p id="centered_msg"></p>

        <canvas id="mainc" style="display: none;"></canvas>
    </div>
</body>

<!-- fill red alert canvas -->
<script>
    const c = document.getElementById("redalert");
    const ctx = c.getContext("2d");

    // Create gradient
    const grdA = ctx.createLinearGradient(0,0,c.width,0);
    grdA.addColorStop(0,"rgba(255, 0, 0, 1)");
    grdA.addColorStop(0.05,"rgba(255, 0, 0, 0)");
    grdA.addColorStop(0.95,"rgba(255, 0, 0, 0)");
    grdA.addColorStop(1,"rgba(255, 0, 0, 1)");

    const grdB = ctx.createLinearGradient(0,0,0,c.height);
    grdB.addColorStop(0,"rgba(255, 0, 0, 1)");
    grdB.addColorStop(0.05,"rgba(255, 0, 0, 0)");
    grdB.addColorStop(0.95,"rgba(255, 0, 0, 0)");
    grdB.addColorStop(1,"rgba(255, 0, 0, 1)");

    // Fill canvas
    ctx.fillStyle = grdA;
    ctx.fillRect(0,0,c.width,c.height);
    ctx.globalCompositeOperation='lighter';
    ctx.fillStyle = grdB;
    ctx.fillRect(0,0,c.width,c.height);
</script>

<!-- Libraries -->
<script src="libs/seedrandom.min.js"></script>
<script src="libs/three.min.js"></script>
<script src="libs/stats.min.js"></script>
<script src="libs/ammo.js"></script>
<script src="libs/socket.io.js"></script>

<!-- Main script -->
<script src="ragen.js"></script>
</html>